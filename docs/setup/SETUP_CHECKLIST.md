# âœ… MongoDB Atlas Setup Checklist

## Quick Summary

You're migrating from local MongoDB to **MongoDB Atlas** (free cloud database).

---

## ğŸ“‹ Setup Checklist

### 1ï¸âƒ£ MongoDB Atlas Account & Cluster

- [ ] Create account at https://www.mongodb.com/cloud/atlas/register
- [ ] Verify email
- [ ] Create new cluster with these settings:
  - **Tier**: M0 (FREE)
  - **Provider**: AWS (recommended)
  - **Region**: Choose closest to you:
    - ğŸ‡ºğŸ‡¸ US: `us-east-1` or `us-west-2`
    - ğŸ‡ªğŸ‡º EU: `eu-west-1` or `eu-central-1`
    - ğŸ‡®ğŸ‡³ India: `ap-south-1`
    - ğŸ‡¸ğŸ‡¬ Asia: `ap-southeast-1`
  - **Name**: `CRM-Cluster` (or your choice)

### 2ï¸âƒ£ Security Configuration

- [ ] Create database user:
  - Username: `crm_admin`
  - Password: Use autogenerated (and save it!)
- [ ] Add IP address:
  - Development: "Add My Current IP"
  - Production: `0.0.0.0/0` (allow from anywhere)

### 3ï¸âƒ£ Get Connection String

- [ ] Click "Connect" on cluster
- [ ] Choose "Connect your application"
- [ ] Select: Driver: **Python** / Version: **3.12+**
- [ ] Copy connection string
- [ ] Replace `<password>` with your actual password

### 4ï¸âƒ£ Configure Application

- [ ] Navigate to `backend/` directory
- [ ] Create `.env` file:
  ```bash
  cd backend
  cp env.template .env
  ```
- [ ] Edit `.env` file and add:
  ```env
  MONGO_URL=mongodb+srv://crm_admin:YourPassword@crm-cluster.xxxxx.mongodb.net/?retryWrites=true&w=majority
  DB_NAME=crm_db
  JWT_SECRET_KEY=<run: python generate_secret_key.py>
  ```
- [ ] If password has special characters (`@`, `!`, `#`), URL encode them:
  - `@` â†’ `%40`
  - `!` â†’ `%21`
  - `#` â†’ `%23`

### 5ï¸âƒ£ Generate Secret Key

- [ ] Run: `python backend/generate_secret_key.py`
- [ ] Copy the generated key
- [ ] Paste it in `.env` file as `JWT_SECRET_KEY`

### 6ï¸âƒ£ Test Connection

- [ ] Run: `python backend/test_mongodb_connection.py`
- [ ] Verify all 6 tests pass âœ…
- [ ] If errors, see troubleshooting below

### 7ï¸âƒ£ Start Application

- [ ] Run: `cd backend && python run.py`
- [ ] Look for: "Connected to MongoDB at mongodb+srv://..."
- [ ] Check: "Database indexes created successfully"
- [ ] Server should be running on http://127.0.0.1:8000

---

## ğŸ¯ Quick Commands

```bash
# 1. Create .env file
cd backend
cp env.template .env

# 2. Generate secret key
python generate_secret_key.py

# 3. Edit .env (use your favorite editor)
nano .env
# or
code .env

# 4. Test MongoDB connection
python test_mongodb_connection.py

# 5. Start backend server
python run.py
```

---

## ğŸ”§ Example Configuration

### Sample `.env` file:

```env
# MongoDB Atlas
MONGO_URL=mongodb+srv://crm_admin:SecurePass123@crm-cluster.abc12.mongodb.net/?retryWrites=true&w=majority
DB_NAME=crm_db

# Security
JWT_SECRET_KEY=a4f8d9e2b3c1a5f7e9d2c4b6a8e1f3d5c7b9a2e4f6d8c1b3a5e7f9d2c4b6a8

# Server
HOST=127.0.0.1
PORT=8000
CORS_ORIGINS=*
```

---

## ğŸ› Troubleshooting

### âŒ Authentication failed

**Cause**: Wrong username/password  
**Fix**:

1. Check credentials in Atlas
2. URL encode special characters in password
3. Try resetting password in Atlas dashboard

### âŒ Connection timeout

**Cause**: Network/firewall issue  
**Fix**:

1. Add your IP in Atlas â†’ Network Access
2. Check internet connection
3. Disable VPN temporarily
4. Verify cluster is not paused

### âŒ dnspython not installed

**Cause**: Missing dependency  
**Fix**:

```bash
pip install dnspython
```

### âŒ Import error: dotenv

**Cause**: Missing dependency  
**Fix**:

```bash
pip install python-dotenv
```

---

## ğŸ“š Documentation Files

| File                                 | Purpose                                      |
| ------------------------------------ | -------------------------------------------- |
| `MONGODB_ATLAS_QUICKSTART.md`        | Detailed step-by-step guide with screenshots |
| `backend/MONGODB_ATLAS_SETUP.md`     | Complete technical documentation             |
| `backend/env.template`               | Template for `.env` file                     |
| `backend/test_mongodb_connection.py` | Connection test script                       |
| `backend/generate_secret_key.py`     | Generate JWT secret key                      |
| `SETUP_CHECKLIST.md`                 | This checklist                               |

---

## ğŸ“ MongoDB Atlas - Provider & Region Guide

### **What is a Provider?**

Cloud platform hosting your database (AWS, Google Cloud, Azure)

### **What is a Region?**

Physical location of data center (e.g., us-east-1 = Virginia, USA)

### **How to Choose?**

1. **Based on Location** (for best speed):

   ```
   Your location â†’ Closest region
   USA East â†’ us-east-1 (Virginia)
   USA West â†’ us-west-2 (Oregon)
   Europe â†’ eu-west-1 (Ireland)
   India â†’ ap-south-1 (Mumbai)
   ```

2. **Based on Your Users**:

   ```
   If users are in Europe â†’ Choose EU region
   If users worldwide â†’ Choose central location
   ```

3. **Provider Choice** (for free tier):
   ```
   AWS â†’ Most regions available âœ… RECOMMENDED
   Google Cloud â†’ Fewer free regions
   Azure â†’ Fewer free regions
   ```

### **Recommended Configuration**:

```
âœ… Provider: AWS
âœ… Region: Closest to you or your primary users
âœ… Tier: M0 (Free)
âœ… Name: CRM-Cluster (or any name)
```

---

## ğŸš€ After Setup

Once everything is working:

1. **Create Admin User**:

   ```bash
   POST http://127.0.0.1:8000/api/auth/register
   {
     "email": "admin@example.com",
     "username": "admin",
     "password": "SecurePassword123",
     "full_name": "Admin User",
     "role": "admin"
   }
   ```

2. **Test Login**:

   ```bash
   POST http://127.0.0.1:8000/api/auth/login
   {
     "email": "admin@example.com",
     "password": "SecurePassword123"
   }
   ```

3. **Start Frontend**:
   ```bash
   cd frontend
   npm start
   ```

---

## ğŸ’¡ Pro Tips

1. **Free Tier Limits**: 512 MB storage (plenty for development)
2. **Automatic Backups**: Free tier includes snapshots
3. **Monitor Usage**: Check Atlas dashboard â†’ Metrics
4. **Cluster Pausing**: Inactive clusters pause after 60 days (free tier)
5. **Multiple Environments**: Create separate clusters for dev/staging/prod

---

## ğŸ” Security Best Practices

- âœ… Use strong, unique passwords
- âœ… Keep `.env` file out of git (already in .gitignore)
- âœ… Use different JWT secrets for dev/prod
- âœ… Restrict IP whitelist in production
- âœ… Never commit credentials to version control
- âœ… Rotate secrets periodically

---

## ğŸ†˜ Need Help?

1. **Read detailed guides**: See files listed above
2. **Check logs**: Look for error messages
3. **MongoDB Atlas docs**: https://www.mongodb.com/docs/atlas/
4. **Test connection**: Run `test_mongodb_connection.py`

---

## âœ… Success Indicators

You're all set when you see:

```
âœ… All 6 connection tests pass
âœ… Backend logs: "Connected to MongoDB at mongodb+srv://..."
âœ… Backend logs: "Database indexes created successfully"
âœ… Server running on http://127.0.0.1:8000
âœ… No authentication errors
âœ… Can create/read data via API
```

---

**ğŸ‰ You're ready to go!**

For detailed instructions, see: `MONGODB_ATLAS_QUICKSTART.md`
